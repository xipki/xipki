<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
	xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0"
	xmlns:ext="http://aries.apache.org/blueprint/xmlns/blueprint-ext/v1.0.0">
	
	<cm:property-placeholder persistent-id="org.xipki.security" update-strategy="reload">
		<cm:default-properties>
		</cm:default-properties>
	</cm:property-placeholder>
	
	<bean id="sshBcBugfix" class="org.xipki.security.SshdBcBugfix">
	</bean>
	
    <bean id="securityFactoryImpl" class="org.xipki.security.SecurityFactoryImpl">
    	<property name="pkcs11Provider" value="${pkcs11.provider}" />
    	<property name="pkcs11Module" value="${pkcs11.module}" />
    </bean>
    
    <service ref="securityFactoryImpl" interface="org.xipki.security.api.SecurityFactory" />

    <bean id="pbePasswordResolver" class="org.xipki.security.PBEPasswordResolver">
    </bean>

    <bean id="passwordResolverImpl" class="org.xipki.security.PasswordResolverImpl">
    	<property name="passwordResolvers">
    		<list>
    			<ref component-id="pbePasswordResolver" />
    		</list>
    	</property>
    </bean>
    
	<service ref="passwordResolverImpl" interface="org.xipki.security.api.PasswordResolver" />

    <bean id="XiPKIProviderRegister" class="org.xipki.security.provider.XiPKIProviderRegister"
    	init-method="regist" destroy-method="unregist">
    	<property name="pkcs11Provider" value="${pkcs11.provider}" />
    	<property name="pkcs11Module" value="${pkcs11.module}" />
    </bean>
    
</blueprint>
